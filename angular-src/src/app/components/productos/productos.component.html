<app-navbar>
</app-navbar>

<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 page-header" style="padding: 0; margin-top: 20px" (window:resize)="onResize($event)">
  <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12" style="padding: 0" [ngStyle]='{"text-align": textAlignTitle}'>
    <h2>Gestión de Productos</h2>
  </div>
</div>
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="padding: 0">
  <div (click)="$event.preventDefault()">
    <tabset [justified]="true">
      <tab heading="Tipo Produtos">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Tipos Producto</h3>
          <hr>
        </div>
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtTP" [settings]="settingsTP" [source]="sourceTP" (create)="showDialogTPC = true;onCreateTP($event);setCursorAddTP()"
            (edit)="showDialogTPU = true;onUpdateTP($event);setCursorUpdateTP()" (delete)="onDeleteTP($event)">
          </ng2-smart-table>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
        </div>
      </tab>
      <tab heading="Productos">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Productos</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtP" [settings]="settingsP" [source]="sourceP" (create)="showDialogPC = true;onCreateP($event);setCursorAddP()"
            (edit)="showDialogPU = true;onUpdateP($event);setCursorUpdateP()" (delete)="onDeleteP($event)" style="overflow-y: hidden;">
          </ng2-smart-table>
          <hr>
        </div>
      </tab>
      <tab heading="Compras" [active]="true">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Compras</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtC" [settings]="settingsC" [source]="sourceC" (create)="showDialogC = true;setCursorAddC()" (edit)="showDialogCU = true;setCursorUpdateC($event)">
          </ng2-smart-table>
          <hr>
        </div>
      </tab>
      <tab heading="Kardex">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Kardex</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <div class="panel panel-default">
            <div class="panel-heading">Datos del Producto</div>
            <div class="panel-body">
              <div class="col-xs-2" style="text-align: right">
                <label class="labelDropdown">Producto:</label>
              </div>
              <div class="col-xs-4">
                <p-dropdown [options]="productosShow" [(ngModel)]="selectedProdKardex" (onChange)="generateKardex()" placeholder="Selecciona.."
                  [style]="{'width':'100%'}" filter="true">
                  <ng-template let-brand pTemplate="item">
                    <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                      <div style="font-size:18px;float:left;margin:10px 10px 0 0">{{brand.label}}--{{brand.id_tipo_producto}}</div>
                    </div>
                  </ng-template>
                </p-dropdown>
              </div>
              <div class="col-xs-3">
                <label class="labelDropdown">Stock Actual:</label>
                <p style="display: inline">0</p>
              </div>
              <div class="col-xs-3">
                <label class="labelDropdown">Cantidad Mínima:</label>
                <p style="display: inline">0</p>
              </div>
              <div class="col-xs-3 col-xs-offset-6">
                <label class="labelDropdown">Precio Costo:</label>
                <p style="display: inline">0</p>
              </div>
              <div class="col-xs-3">
                <label class="labelDropdown">Precio Venta:</label>
                <p style="display: inline">0</p>
              </div>
            </div>
          </div>
        </div>
        <br>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtK" [settings]="settingsK" [source]="sourceK" (create)="showDialogK = true;setCursorAddK()" (edit)="showDialogKU = true;setCursorUpdateK($event)"
            (delete)="onDeleteK($event)" (userRowSelect)="showKardex($event)">
          </ng2-smart-table>
          <hr>
        </div>
      </tab>
      <tab heading="Proveedores">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Proveedores</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtProve" [settings]="settingsProve" [source]="sourceProve" (create)="showDialogProve = true;setCursorAddProve()"
            (edit)="showDialogProveU = true;setCursorUpdateProve($event)" (delete)="onDeleteProve($event)" (userRowSelect)="showProveedor($event)">
          </ng2-smart-table>
          <hr>
        </div>
      </tab>
      <tab heading="Promociones">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Promociones</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtPro" [settings]="settingsPro" [source]="sourcePro" (create)="showDialogPro = true;setCursorAddPro()"
            (delete)="onDeletePro($event)"></ng2-smart-table>
          <hr>
        </div>
      </tab>
      <tab heading="Materia Prima">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <hr>
          <h3 style="text-align: center">Materia Prima</h3>
          <hr>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
          <ng2-smart-table id="dtMateria" [settings]="settingsMat" [source]="sourceMat" (create)="showDialogMat = true;setCursorAddMat()"
            (edit)="showDialogMatU = true;setCursorUpdateMat();onUpdateMat($event)" (delete)="onDeleteMat($event)">
          </ng2-smart-table>
          <hr>
        </div>
      </tab>
    </tabset>
  </div>
</div>

<!-- Add TP -->
<p-dialog [(visible)]="showDialogTPC" modal="modal" width="400" [responsive]="true">
  <p-header>
    Registrar Tipo Producto
  </p-header>
  <form (ngSubmit)="onAddTPSubmit()" #tpCForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint">Los campos marcados con (*) son obligatorios:</div>
      </div>
      <div class="ui-g-12">
        <label>Nombre*:</label>
        <input type="text" [(ngModel)]="desc_tipo_producto" (ngModelChange)="onChangeDescTPC($event)" id="descTPC" name="descTPC"
          minlength="4" placeholder="Descripción tipo producto" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
          event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " required>
      </div>
      <div class="ui-g-12">
        <label>Logotipo*:</label>
        <div style="display: inline" class="form-hint"> (Peso máximo: 1 Mb, Tamaño preferido: 160 x 160 px)</div>
        <input #myInput2 type="file" placeholder="File Name" (change)="onChangeFileTP($event)" id="filesTP" name="filesTP" class="form-control inputfile input-sm"
          accept="image/*" tooltip="Esta imagen se mostrará por defecto, en el módulo de VENTAS." tooltipPlacement="bottom"
          required title=" ">
      </div>
      <div class="ui-g-12 form-hint">
        <p><b>Nota: </b>Si algún producto no cuenta con una imagen, ésta imagen se mostrará por defecto.</p>
        <hr>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <button type="submit" class="btn btn-primary" style="font-size: 11px;" [disabled]="!tpCForm.form.valid || flagImageTP">Registrar</button>
      <button class="btn btn-default" style="font-size: 11px;" (click)="showDialogTPC = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Update TP -->
<p-dialog [(visible)]="showDialogTPU" modal="modal" width="400" [responsive]="true">
  <p-header>
    Actualizar Tipo Producto
  </p-header>
  <form (ngSubmit)="onUpdateTPSubmit()" #tpUForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint">Los campos marcados con (*) son obligatorios:</div>
      </div>
      <div class="ui-g-4">
        <label style="display: inline-block">Id:</label>
        <p class="ids" style="text-align: center;">{{tipoProductoUpdate._id | slice:-6}}</p>
      </div>
      <div class="ui-g-8">
        <label>Nombre*:</label>
        <input type="text" [(ngModel)]="tipoProductoUpdate.desc_tipo_producto" (ngModelChange)="onChangeDescTPU($event)" id="descTPU"
          name="descTPU" minlength="4" placeholder="Descripción tipo producto" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " required>
      </div>
      <div class="ui-g-12">
        <label>Logotipo*:</label>
        <div style="display: inline" class="form-hint"> (Peso máximo: 1 Mb, Tamaño preferido: 160 x 160 px)</div>
        <ng-template #toolTipTemplateTP>
          <img src={{tipoProductoUpdate.path}} width="50%" />
        </ng-template>
        <a href="#" [tooltipHtml]="toolTipTemplateTP" tooltipPlacement="bottom" tooltipAnimation=false>
          <input #myInput3 type="file" placeholder="File Name" (change)="onChangeFileTPU($event)" id="filesTPU" name="filesTPU"
          minlength="1" class="form-control inputfile input-sm" accept="image/*" [ngStyle]="{'color': colorUpdate}" title=" " required>
        </a>
      </div>
      <div class="ui-g-12 form-hint">
        <p><b>Nota: </b>Si algún producto no cuenta con una imagen, ésta imagen se mostrará por defecto.</p>
        <hr>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <button type="submit" style="font-size: 11px" [disabled]="!tpUForm.form.valid" class="btn btn-primary">Actualizar</button>
      <button type="button" style="font-size: 11px" (click)="showDialogTPU=false" class="btn btn-default">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Add P-->
<p-dialog [(visible)]="showDialogPC" modal="modal" width="950" [responsive]="true" positionTop="40">
  <p-header>
    Registrar Producto
  </p-header>
  <form (ngSubmit)="onAddPSubmit()" #formProd="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint"><b>Nota:</b>&nbsp;Los campos marcados con (*) son obligatorios.</div>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label for="nombrePC">Nombre<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" [(ngModel)]="nombre" (ngModelChange)="onChangeNombrePC($event)" id="nombrePC" name="nombrePC" placeholder="Nombre único del producto"
          class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" required>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label for="tipoPC">Tipo Producto<span class="requiredClass">&nbsp;*</span></label>
        <select [(ngModel)]="selected_tipo_producto" id="tipoPC" name="tipoPC" class="form-control input-sm" [disabled]="flagProductoGasto"
          required>
          <option value="" disabled selected hidden>Selecciona...</option>
          <option *ngFor="let c of tipo_productos" [ngValue]="c">{{c.desc_tipo_producto}}</option>
        </select>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-12">
        <label for="filesC">Logotipo:</label>
        <div style="display: inline" class="form-hint"> (Peso máximo: 1 Mb, Tamaño preferido: 160 x 160 px)</div>
        <input #myInput type="file" (change)="onChangeFileC($event)" id="filesC" name="filesC" class="form-control inputfile input-sm"
          accept="image/*" tooltip="Esta imagen se mostrará por defecto, en el módulo de VENTAS" tooltipPlacement="bottom"
          title=" " [disabled]="flagProductoGasto">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Cantidad Existente<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="cant_existente" id="cantPC" name="cantPC" placeholder="0.00"
          class="form-control input-sm" (click)="$event.target.select()" [disabled]="flagSubProd" required>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Cantidad Mínima<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="cant_minima" id="cantMinPC" name="cantMinPC" placeholder="0.00"
          class="form-control input-sm" (click)="$event.target.select()" tooltip="Cuando el producto sea menor a esta cantidad, se mostrará una alerta en el módulo de VENTAS."
          tooltipPlacement="bottom" [disabled]="flagSubProd" required>
        <button type="button" (click)="showDlgImp=true; calcImp();" *ngIf="precio_costo > 0" class="btn btn-info btn-block btn-sm cuzButton padTop">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Impuestos Compra
        </button>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Contenido<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="contenido" id="contPC" name="contPC" placeholder="0.00"
          class="form-control input-sm" tooltip="Al almacenar el valor, el sistema realizará la conversión a Mililitros o Gramos."
          tooltipPlacement="bottom" [disabled]="flagSubProd || blockFlagCont" (click)="$event.target.select()">
        <button type="button" (click)="showDlgImpV=true; calcImpV();" *ngIf="precio_venta > 0" class="btn btn-info btn-block btn-sm cuzButton padTop">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Impuestos Venta
        </button>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Unidad de Medida<span class="requiredClass">&nbsp;*</span></label>
        <select [(ngModel)]="selectedUmMat" (ngModelChange)="onChangeUmMat($event)" id="tipoUmProd" name="tipoUmProd" class="form-control input-sm"
          [disabled]="flagSubProd" required>
          <option *ngFor="let c of lstUnidadMedida" [ngValue]="c">{{c.label}}</option>
        </select>
        <select [(ngModel)]="selectedUmMat1" id="UmProd" name="UmProd" class="form-control input-sm padTop" *ngIf="flagUnits" [disabled]="flagSubProd"
          required>
          <option *ngFor="let c of lstUnidadMedida1" [ngValue]="c">{{c.label}}</option>
        </select>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Precio Costo<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [(ngModel)]="precio_costo" id="pcPC" name="pcPC" placeholder="0.00" class="form-control input-sm"
          (ngModelChange)="valueChangePrecioCompra($event)" (click)="$event.target.select()" [disabled]="flagSubProd">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Ganancia<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ suffix :' %',prefix: ''}" [(ngModel)]="utilidad" id="utilidadPC" name="utilidadPC"
          placeholder="0.00" class="form-control input-sm" (ngModelChange)="valueChangeGanancia($event)" (click)="$event.target.select()"
          tooltip="Los productos con ganancia 0%, no se mostrarán en el módulo de VENTAS." tooltipPlacement="bottom">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Precio Venta<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" currencyMask type="text" [(ngModel)]="precio_venta" id="pvPC" name="pvPC" placeholder="0.00" class="form-control input-sm"
          (ngModelChange)="valueChangePrecioVenta($event)" (click)="$event.target.select()" [readonly]="flagProductoGasto">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6" *ngIf="!flagProductoGasto">
        <div style="text-align: center">
          <label>Receta (Subproductos):</label><br>
          <md-slide-toggle [color]="color" [checked]="checked" [(ngModel)]="flagSubProd" style="padding-top: 7px" (ngModelChange)="controlarPrecioCosto($event)"
            id="btnSubProd" name="btnSubProd" tooltip="Un producto compuesto contiene uno o más productos estándar." tooltipPlacement="bottom">
          </md-slide-toggle>
        </div>
      </div>
      <div class="panel panel-default" style="width: 100%; margin: auto 7px auto 7px;" *ngIf="flagSubProd">
        <div class="ui-g-4" style="text-align: center">
          <label>Productos Existentes:</label>
          <p-listbox [options]="productosShow" [(ngModel)]="selected_producto" filter="filter" [style]="{'text-align':'left','border-color':borderStyleProdExistente}"
            [listStyle]="{'max-height':'135px'}" id="prodExistente" name="prodExistente" (onChange)="onChangeProdExistentes($event)">
            <ng-template let-car pTemplate="item">
              {{car.nombre}}
              <span class="badge" style="margin-top: -4px;">$ {{ car.precio_costo | number : '1.2-2'}}</span>
              <span *ngIf="car.contenido > 0" class="badge" style="margin-top: -4px;">{{car.contenido | number : '1.2-2'}}&nbsp;
                <span *ngIf="car.unidad_medida.split('-')[0] == 'Masa'">gr</span>
              <span *ngIf="car.unidad_medida.split('-')[0] == 'Volumen'">ml</span>
              </span>
              <span *ngIf="car.contenido == 0" class="badge" style="margin-top: -4px;">Unidades</span>
            </ng-template>
          </p-listbox>
        </div>
        <div class="ui-g-4" style="text-align: center">
          <div class="ui-g-12 ui-g-nopad">
            <label>Unidad Medida:</label>
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <select [(ngModel)]="unidadMedidaSuproducto" id="um" name="um" class="form-control input-sm" style="width: 100%">
              <option value="" disabled selected hidden>Selecciona...</option>
              <option *ngFor="let c of lstUnitsComp" [ngValue]="c">{{c.label}}</option>
            </select>
          </div>
          <div class="ui-g-12 ui-g-nopad"><br>
            <label>Cantidad:</label>
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="cantSubprod" id="cantSubprod" name="cantSubprod" placeholder="0.00"
              class="form-control input-sm" (click)="$event.target.select()">
          </div>
          <div class="ui-g-12 ui-g-nopad"><br>
            <i id="addIcon" class="fa fa-plus-square fa-2x" (click)="addItem()" aria-hidden="true" style="vertical-align: middle"></i>
            <i id="timesIcon" class="fa fa-minus-square fa-2x" (click)="deleteItem()" aria-hidden="true" style="vertical-align: middle"></i>
          </div>
        </div>
        <div class="ui-g-4" style="text-align: center">
          <label>Productos Seleccionados:</label>
          <p-listbox [options]="subproductoV" [(ngModel)]="selected_prodSelec" filter="filter" [style]="{'text-align':'left','border-color':borderStyleProdSelec}"
            [listStyle]="{'max-height':'135px'}" id="prodSeleccionado" name="prodSeleccionado" (onChange)="onChangeProdSelec($event)">
            <ng-template let-car let-i="index" pTemplate="item" id="tmpProd" name="tmpProd" #tmpProd>
              &nbsp;{{car.nombre}}
              <span class="badge" style="margin-top: -4px;">{{car.cantidad}}</span>
              <span class="badge" style="margin-top: -4px;">$ {{ car.precio_costo | number : '1.2-2'}}</span>
            </ng-template>
          </p-listbox>
        </div>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <hr>
      <button type="submit" class="btn btn-primary" style="font-size: 11px" [disabled]="!formProd.form.valid">Registrar</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDialogPC = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Impuestos Compra-->
<p-dialog [(visible)]="showDlgImp" modal="modal" width="550" [responsive]="true" positionTop="40">
  <p-header>
    Impuestos Compra
  </p-header>
  <form (ngSubmit)="addImpuesto()" #formImp="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="col-sm-4 centerClass">
          <label>Nombre</label>
        </div>
        <div class="col-sm-4 centerClass">
          <label>Porcentaje</label>
        </div>
        <div class="col-sm-4 centerClass">
          <label>Valor</label>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpIVA" name="descImpIVA" [(ngModel)]="objIva.desc" readonly>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="objIva.porcentaje"
              (ngModelChange)="valueChangePorIva($event)" id="porcentajeImpIVA" name="PorcentajeImpIVA" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask type="text" class="form-control input-sm" id="valorImpIVA" name="valorImpIVA" [(ngModel)]="objIva.valor"
              readonly>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpICE" name="descImpICE" [(ngModel)]="objIce.desc" readonly>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" id="PorcentajeImpICE"
              name="PorcentajeImpICE" [(ngModel)]="objIce.porcentaje" (ngModelChange)="valueChangePorIce($event)" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask type="text" class="form-control input-sm" id="valorImpICE" name="valorImpICE" [(ngModel)]="objIce.valor"
              readonly>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpOtro" name="descImpOtro" [(ngModel)]="objOtro.desc" (ngModelChange)="onChangeDescOtroImp($event)"
              placeholder="Nombre">
          </div>
        </div>
        <div class="col-sm-4" sty>
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="objOtro.porcentaje"
              (ngModelChange)="valueChangePorOtro($event)" id="porcentajeImpNew" name="porcentajeImpNew" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <div class="input-group">
              <input currencyMask type="text" class="form-control input-sm" [(ngModel)]="objOtro.valor" id="valorImpNew" name="valorImpNew"
                aria-describedby="basic-addon1" readonly>
              <span class="input-group-addon input-sm" (click)="addRowImp();" id="basic-addon1" style="background-color: #93C54A">
              <i class="fa fa-plus fa-lg" aria-hidden="true" style="color: white"></i>
            </span>
            </div>
          </div>
        </div>

        <div *ngFor="let field of choiceSet.nombre; trackBy:trackByFn; let i = index;">
          <div class="form-group col-sm-4">
            <input type="text" class="form-control input-sm" [(ngModel)]="choiceSet.nombre[i]" (ngModelChange)="onChangeDescV(i)" placeholder="Nombre"
              (click)="$event.target.select()" id="nombreOtro{{i}}" name="nombreOtro{{i}}" required>
          </div>
          <div class="form-group col-sm-4">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="choiceSet.porcentaje[i]"
              (ngModelChange)="valueChangePorGeneric(i)" (click)="$event.target.select()" id="porcentajeOtro{{i}}" name="porcentajeOtro{{i}}">
          </div>
          <div class="form-group col-sm-4">
            <div class="input-group">
              <input currencyMask type="text" class="form-control input-sm" [(ngModel)]="choiceSet.valor[i]" id="valorOtro{{i}}" name="valorOtro{{i}}"
                readonly>
              <span class="input-group-addon input-sm" (click)="removeChoice(i)" id="basic-addon1" style="background-color: #D95455">
              <i class="fa fa-minus fa-lg" aria-hidden="true" style="color: white"></i>
            </span>
            </div>
          </div>
        </div>

      </div>
      <hr>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <button class="btn btn-primary" style="font-size: 11px" [disabled]="!formImp.form.valid">Guardar</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDlgImp = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Impuestos Venta-->
<p-dialog [(visible)]="showDlgImpV" modal="modal" width="550" [responsive]="true" positionTop="40">
  <p-header>
    Impuestos Venta
  </p-header>
  <form (ngSubmit)="addImpuestoV()" #formImpV="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="col-sm-4 centerClass">
          <label>Nombre</label>
        </div>
        <div class="col-sm-4 centerClass">
          <label>Porcentaje</label>
        </div>
        <div class="col-sm-4 centerClass">
          <label>Valor</label>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpIvaV" name="descImpIvaV" [(ngModel)]="objIvaV.desc" readonly>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="objIvaV.porcentaje"
              (ngModelChange)="valueChangePorIvaV($event)" id="porcentajeImpIvaV" name="porcentajeImpIvaV" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask type="text" class="form-control input-sm" id="valorImpIvaV" name="valorImpIvaV" [(ngModel)]="objIvaV.valor"
              readonly>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpIceV" name="descImpIceV" [(ngModel)]="objIceV.desc" readonly>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" id="PorcentajeImpIceV"
              name="PorcentajeImpIceV" [(ngModel)]="objIceV.porcentaje" (ngModelChange)="valueChangePorIceV($event)" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask type="text" class="form-control input-sm" id="valorImpIceV" name="valorImpIceV" [(ngModel)]="objIceV.valor"
              readonly>
          </div>
        </div>

        <div class="col-sm-4">
          <div class="form-group">
            <input type="text" class="form-control input-sm" id="descImpOtroV" name="descImpOtroV" [(ngModel)]="objOtroV.desc" (ngModelChange)="onChangeDescOtroImpV($event)"
              placeholder="Nombre">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="objOtroV.porcentaje"
              (ngModelChange)="valueChangePorOtroV($event)" id="porcentajeImpNewV" name="porcentajeImpNewV" (click)="$event.target.select()">
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-group">
            <div class="input-group">
              <input currencyMask type="text" class="form-control input-sm" [(ngModel)]="objOtroV.valor" id="valorImpNewV" name="valorImpNewV"
                aria-describedby="basic-addon1V" readonly>
              <span class="input-group-addon input-sm" (click)="addRowImpV();" id="basic-addon1V" style="background-color: #93C54A">
              <i class="fa fa-plus fa-lg" aria-hidden="true" style="color: white"></i>
            </span>
            </div>
          </div>
        </div>

        <div *ngFor="let field of choiceSetV.nombre; trackBy:trackByFn; let i = index;">
          <div class="form-group col-sm-4">
            <input type="text" class="form-control input-sm" [(ngModel)]="choiceSetV.nombre[i]" (ngModelChange)="onChangeDescV1(i)" placeholder="Nombre"
              (click)="$event.target.select()" id="nombreOtroV{{i}}" name="nombreOtroV{{i}}" required>
          </div>
          <div class="form-group col-sm-4">
            <input currencyMask [options]="{ suffix :' %',prefix: ''}" type="text" class="form-control input-sm" [(ngModel)]="choiceSetV.porcentaje[i]"
              (ngModelChange)="valueChangePorGenericV(i)" (click)="$event.target.select()" id="porcentajeOtroV{{i}}" name="porcentajeOtroV{{i}}">
          </div>
          <div class="form-group col-sm-4">
            <div class="input-group">
              <input currencyMask type="text" class="form-control input-sm" [(ngModel)]="choiceSetV.valor[i]" id="valorOtroV{{i}}" name="valorOtroV{{i}}"
                readonly>
              <span class="input-group-addon input-sm" (click)="removeChoiceV(i)" style="background-color: #D95455">
              <i class="fa fa-minus fa-lg" aria-hidden="true" style="color: white"></i>
            </span>
            </div>
          </div>
        </div>

      </div>
      <hr>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <button class="btn btn-primary" style="font-size: 11px" [disabled]="!formImpV.form.valid">Guardar</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDlgImpV = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Update P -->
<p-dialog [(visible)]="showDialogPU" modal="modal" width="950" [responsive]="true" positionTop="40">
  <p-header>
    Actualizar Producto
  </p-header>
  <form (ngSubmit)="onUpdatePSubmit()" #formProdU="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint"><b>Nota:</b>&nbsp;Los campos marcados con (*) son obligatorios:</div>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label for="nombrePU">Nombre<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" [(ngModel)]="productoUpdate.nombre" (ngModelChange)="onChangeNombrePU($event)" id="nombrePU" name="nombrePU"
          placeholder="nombre único del producto" class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
          event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" required>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label for="tipoPU">Tipo Producto<span class="requiredClass">&nbsp;*</span></label>
        <select [(ngModel)]="productoUpdate.id_tipo_producto" id="tipoPU" name="tipoPU" class="form-control input-sm" [disabled]="flagProductoGasto"
          required>
          <option value="" disabled selected hidden>Selecciona...</option>
          <option *ngFor="let c of tipo_productos">{{c.desc_tipo_producto}}</option>
        </select>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-12">
        <label for="filesU">Logotipo</label>
        <div style="display: inline" class="form-hint"> (Peso máximo: 1 Mb, Tamaño preferido: 160 x 160 px)</div>
        <ng-template #toolTipTemplate>
          <img src={{productoUpdate.path}} width="50%" />
          <p>Esta imagen se mostrará por defecto, en el módulo de VENTAS"</p>
        </ng-template>
        <a href="#" [tooltipHtml]="toolTipTemplate" tooltipPlacement="bottom" tooltipAnimation=false>
          <input #myInput1 type="file" placeholder="File Name" (change)="onChangeFileU($event)" id="filesU" name="filesU"
          class="form-control inputfile input-sm" accept="image/*" [ngStyle]="{'color': colorUpdate}" [disabled]="flagProductoGasto">
        </a>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Cantidad Existente<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="productoUpdate.cant_existente" id="cantPU" name="cantPU"
          placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()" [disabled]="flagSubProdUpdate">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Cantidad Mínima<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="productoUpdate.cant_minima" id="cantMinPU" name="cantMinPU"
          placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()" tooltip="Cuando el producto sea menor a esta cantidad, se mostrará una alerta en el módulo de VENTAS."
          tooltipPlacement="bottom" [disabled]="flagSubProd">
        <button type="button" (click)="showDlgImp=true; calcImp();" *ngIf="precio_costo > 0" class="btn btn-info btn-block btn-sm cuzButton padTop">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Impuestos Compra
        </button>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Contenido<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" currencyMask [options]="{ prefix: ''}" [(ngModel)]="productoUpdate.contenido" id="contPU" name="contPU"
          placeholder="0.00" class="form-control input-sm" tooltip="Al almacenar el valor, el sistema realizará la conversión a Mililitros o Gramos."
          tooltipPlacement="bottom" [disabled]="flagSubProdUpdate || blockFlagCont" (click)="$event.target.select()">
        <button type="button" (click)="showDlgImpV=true; calcImpV();" *ngIf="precio_venta > 0" class="btn btn-info btn-block btn-sm cuzButton padTop">
          <i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Impuestos Venta
        </button>
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Unidad de Medida<span class="requiredClass">&nbsp;*</span></label>
        <select [(ngModel)]="selectedUmMat" (ngModelChange)="onChangeUmMat($event)" id="tipoUmProd" name="tipoUmProd" class="form-control input-sm"
          [disabled]="flagSubProd" required>
          <option *ngFor="let c of lstUnidadMedida" [ngValue]="c">{{c.label}}</option>
        </select>
        <select [(ngModel)]="selectedUmMat1" id="UmProd" name="UmProd" class="form-control input-sm padTop" *ngIf="flagUnits" [disabled]="flagSubProd"
          required>
          <option *ngFor="let c of lstUnidadMedida1" [ngValue]="c">{{c.label}}</option>
        </select>
      </div>

      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Precio Costo<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" currencyMask type="text" [(ngModel)]="productoUpdate.precio_costo" id="pcPU" name="pcPU" class="form-control input-sm"
          placeholder="0.00" (ngModelChange)="valueChangePrecioCompraU($event)" [disabled]="flagSubProdUpdate" (click)="$event.target.select()">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Ganancia<span class="requiredClass">&nbsp;*</span></label>
        <input currencyMask type="text" type="text" [options]="{ suffix :' %',prefix: ''}" [(ngModel)]="productoUpdate.utilidad"
          id="utilidadPU" name="utilidadPU" placeholder="0.00" class="form-control input-sm" (ngModelChange)="valueChangeGananciaU($event)"
          tooltip="Los productos con ganancia 0%, no se mostrarán en el módulo de VENTAS." tooltipPlacement="bottom" (click)="$event.target.select()">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6">
        <label>Precio Venta<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" currencyMask type="text" [(ngModel)]="productoUpdate.precio_venta" id="pvPU" name="pvPU" placeholder="0.00"
          class="form-control input-sm" (ngModelChange)="valueChangePrecioVentaU($event)" [disabled]="flagProductoGasto" (click)="$event.target.select()">
      </div>
      <div class="ui-g-3 ui-xl-3 ui-lg-3 ui-md-3 ui-sm-6" *ngIf="!flagProductoGasto">
        <div style="text-align: center">
          <label>Receta (Subproductos):</label><br>
          <md-slide-toggle [color]="color" [checked]="checked" [(ngModel)]="flagSubProdUpdate" style="padding-top: 7px" (ngModelChange)="controlarPrecioCostoU($event)"
            id="btnSubProdU" name="btnSubProdU" tooltip="Un producto compuesto contiene uno o más productos estándar." tooltipPlacement="bottom">
          </md-slide-toggle>
        </div>
      </div>
      <div class="panel panel-default" style="width: 100%;margin-bottom: 0px" *ngIf="flagSubProdUpdate">
        <div class="ui-g-4" style="text-align: center">
          <label>Productos Existentes:</label>
          <p-listbox [options]="productosShow" [(ngModel)]="selected_productoU" filter="filter" [style]="{'text-align':'left','border-color':borderStyleProdExistente}"
            [listStyle]="{'max-height':'135px'}" id="prodExistenteU" name="prodExistenteU" (onChange)="onChangeProdExistentesU($event)">
            <ng-template let-car pTemplate="item">
              {{car.nombre}}
              <span class="badge" style="margin-top: -4px;">$ {{ car.precio_costo | number : '1.2-2'}}</span>
              <span *ngIf="car.contenido > 0" class="badge" style="margin-top: -4px;">{{car.contenido | number : '1.2-2'}}&nbsp;
                <span *ngIf="car.unidad_medida.split('-')[0] == 'Masa'">gr</span>
              <span *ngIf="car.unidad_medida.split('-')[0] == 'Volumen'">ml</span>
              </span>
              <span *ngIf="car.contenido == 0" class="badge" style="margin-top: -4px;">Unidades</span>
            </ng-template>
          </p-listbox>
        </div>
        <div class="ui-g-4" style="text-align: center">
          <br>
          <div class="ui-g-12 ui-g-nopad">
            <label>Unidad Medida:</label>
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <select [(ngModel)]="unidadMedidaSuproducto" id="umU" name="umU" class="form-control input-sm" style="width: 100%">
            <option *ngFor="let c of lstUnitsComp" [ngValue]="c">{{c.label}}</option>
          </select>
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <label>Cantidad:</label>
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="cantSubProdU" id="cantSubProdU" name="cantSubProdU"
              placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
          </div>
          <div class="ui-g-12 ui-g-nopad">
            <i id="addIcon" class="fa fa-plus-square fa-2x" (click)="addItemU()" aria-hidden="true" style="vertical-align: middle"></i>
            <i id="timesIcon" class="fa fa-minus-square fa-2x" (click)="deleteItemU()" aria-hidden="true" style="vertical-align: middle"></i>
          </div>
        </div>
        <div class="ui-g-4" style="text-align: center">
          <label>Productos Seleccionados:</label>
          <p-listbox [options]="productoUpdate.subproductoV" [(ngModel)]="selected_prodSelecU" filter="filter" [style]="{'text-align':'left','border-color':borderStyleProdSelec}"
            [listStyle]="{'max-height':'135px'}" id="prodSeleccionadoU" name="prodSeleccionadoU" (onChange)="onChangeProdSelecU($event)">
            <ng-template let-car let-i="index" pTemplate="item" id="tmpProd" name="tmpProd" #tmpProd>
              &nbsp;{{car.nombre}}
              <span class="badge" style="margin-top: -4px;">{{car.cantidad}}</span>
              <span class="badge" style="margin-top: -4px;">$ {{ car.precio_costo | number : '1.2-2'}}</span>
            </ng-template>
          </p-listbox>
        </div>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <hr>
      <button type="submit" class="btn btn-primary" style="font-size: 11px" [disabled]="!formProdU.form.valid">Actualizar</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDialogPU = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Add Promo -->
<p-dialog [(visible)]="showDialogPro" modal="modal" width="600" [responsive]="true">
  <p-header>
    Registrar Promoción
  </p-header>
  <div class="ui-g ui-fluid">
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <label>Nombre*:</label>
      <input type="text" [(ngModel)]="objPromo.nombre" (ngModelChange)="onChangeNombrePromo($event)" id="nombrePromo" name="nombrePromo"
        placeholder="Nombre único de la promoción" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
        event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
        tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" tabindex="1" required>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
      <div class="ui-g-12 ui-g-nopad">
        <label>Tipo promoción*:</label>
      </div>
      <div class="ui-g-5">
        <p style="padding-left: 20px" tooltip="Por la compra de uno o varios productos puedes asociar uno o varios productos de promocion."
          tooltipPlacement="bottom">
          Asociar productos
        </p>
      </div>
      <div class="ui-g-2" style="margin-left: -10px">
        <md-slide-toggle [color]="color" [checked]="chkTipoPromo" [(ngModel)]="flagTipoPromo" style="padding-top: 2px">
        </md-slide-toggle>
      </div>
      <div class="ui-g-5">
        <p style="padding-left: 15px" tooltip="Puedes descontar un porcentaje del precio de venta del producto." tooltipPlacement="bottom">
          Descontar precio
        </p>
      </div>
    </div>
    <!-- Asociar Producto-->
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="!flagTipoPromo">
      <p-listbox [options]="productosShow" [(ngModel)]="selectProdPromo" filter="filter" [listStyle]="{'max-height':'300px'}" [style]="{'width':'100%','height':'300px','border-color': bcLstProductosPromo }">
        <p-header>
          Productos Disponibles
        </p-header>
        <ng-template let-car pTemplate="item">
          {{car.label}}
          <span class="badge" style="margin-top: -2.5px" tooltip="Precio de venta">$ {{ car.precio_venta | number : '1.2-2'}}</span>
        </ng-template>
      </p-listbox>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="!flagTipoPromo">
      <div class="ui-g-4 ui-md-4" style="padding-top: 8px; text-align: right;"><label>&nbsp;&nbsp;&nbsp;Por:</label></div>
      <div class="input-group ui-g-4 ui-md-4" style="margin-top: -2px">
        <input [(ngModel)]="cantPor" type="text" class="form-control input-sm" id="cantPor" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
          maxlength="2" min="0" style="z-index: 1" tabindex="6" (click)="$event.target.select()">
        <div class="input-group-btn-vertical">
          <button (click)="addCantPor()" class="btn btn-default" type="button" style="outline: 0;"><i class="fa fa-caret-up"></i></button>
          <button (click)="lessCantPor()" class="btn btn-default" type="button" style="outline: 0;"><i class="fa fa-caret-down"></i></button>
        </div>
      </div>
      <div class="ui-g-4 ui-md-4">
        <i id="addIcon" class="fa fa-plus-square fa-2x" (click)="addItemP()" aria-hidden="true"></i>
        <i id="timesIcon" class="fa fa-minus-square fa-2x" (click)="deleteItemP()" aria-hidden="true"></i>
      </div>
      <div class="ui-g-12 ui-md-12">
        <p-listbox [options]="lstProductosP" [(ngModel)]="selected_prodP" [listStyle]="{'max-height':'50px'}" [style]="{'width':'100%','border-color': bcLstProductosP }">
          <p-header>
            Productos Seleccionados
          </p-header>
          <ng-template let-car pTemplate="item">
            {{car.value.label}}
            <span class="badge" style="margin-top: -2.5px" tooltip="Unidades">{{car.cantidad}}u</span>
            <span class="badge" style="margin-top: -2.5px" tooltip="Precio total">$ {{ car.value.precio_venta * car.cantidad | number : '1.2-2' }}</span>
          </ng-template>
        </p-listbox><br>
      </div>
      <div class="ui-g-4 ui-md-4" style="padding-top: 8px; text-align: right;"><label>&nbsp;&nbsp;&nbsp;Recibe:</label></div>
      <div class="input-group ui-g-4 ui-md-4" style="margin-top: -2px">
        <input [(ngModel)]="cantRecibe" type="text" class="form-control input-sm" id="cantRecibe" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
          maxlength="2" min="0" style="z-index: 1" tabindex="6" (click)="$event.target.select()">
        <div class="input-group-btn-vertical">
          <button (click)="addCantRecibe()" class="btn btn-default" type="button" style="outline: 0"><i class="fa fa-caret-up"></i></button>
          <button (click)="lessCantRecibe()" class="btn btn-default" type="button" style="outline: 0"><i class="fa fa-caret-down"></i></button>
        </div>
      </div>
      <div class="ui-g-4 ui-md-4">
        <i id="addIcon" class="fa fa-plus-square fa-2x" (click)="addItemR()" aria-hidden="true" style="vertical-align: middle"></i>
        <i id="timesIcon" class="fa fa-minus-square fa-2x" (click)="deleteItemR()" aria-hidden="true" style="vertical-align: middle"></i>
      </div>
      <div class="ui-g-12 ui-md-12">
        <p-listbox [options]="lstProductosR" [(ngModel)]="selected_prodR" [listStyle]="{'max-height':'50px'}" [style]="{'width':'100%','border-color': bcLstProductosR }">
          <p-header>
            Productos Seleccionados
          </p-header>
          <ng-template let-car pTemplate="item">
            {{car.value.label}}
            <span class="badge" style="margin-top: -2.5px" tooltip="Unidades">{{car.cantidad}}u</span>
            <span class="badge" style="margin-top: -2.5px" tooltip="Precio total">$ {{ car.value.precio_venta * car.cantidad | number : '1.2-2' }}</span>
          </ng-template>
        </p-listbox>
      </div>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="!flagTipoPromo">
      <br>
      <label>Precio normal:</label>
      <input currencyMask type="text" [(ngModel)]="valorNormal" class="form-control input-sm" placeholder="0.00" tooltip="Valor de la promocion"
        tooltipPlacement="bottom" title=" " tabindex="2" id="desdePromo" name="desdePromo" readonly>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="!flagTipoPromo">
      <br>
      <label>Precio promoción:</label>
      <input currencyMask type="text" [(ngModel)]="valorPromo" class="form-control input-sm" placeholder="0.00" tooltip="Valor de la promocion"
        tooltipPlacement="bottom" title=" " tabindex="2" id="desdePromo" name="desdePromo">
    </div>
    <!-- Decontar en precio-->
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagTipoPromo">
      <label>Tipo Descuento*:</label>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="color: white" *ngIf="flagTipoPromo">
      <label>Guardar*:</label>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagTipoPromo">
      <div class="ui-g-5" style="text-align: right;">
        <p tooltip="Aplicar el descuento a TODO un tipo de producto." tooltipPlacement="bottom">
          Grupal
        </p>
      </div>
      <div class="ui-g-2" style="text-align: center;">
        <md-slide-toggle [color]="color" [checked]="checked" [(ngModel)]="flagTipoDesc" style="padding-top: 2px" (ngModelChange)="changeFlag($event)">
        </md-slide-toggle>
      </div>
      <div class="ui-g-5" style="text-align: left; padding-left: 15px">
        <p tooltip="Aplicar el descuento a un SOLO producto." tooltipPlacement="bottom">Individual</p>
      </div>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="text-align: center;" *ngIf="flagTipoPromo">
      <i id="addIcon" class="fa fa-pencil-square fa-2x" style="padding-top: 2px" (click)="addNewPrice()" aria-hidden="true" tooltip="Guardar nuevo/s precio/s."
        tooltipPlacement="bottom"></i>
    </div>
    <br>

    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagTipoPromo">
      <p-listbox [options]="lstTipoProductos" [(ngModel)]="selected_tp" filter="filter" [listStyle]="{'max-height':'130px'}" [style]="{'width':'100%','border-color': bcLstProdM }"
        id="lbTP" name="lbTP" (onChange)="onChangelbTP($event)">
        <p-header>
          Tipo Producto
        </p-header>
        <ng-template let-car pTemplate="item">
          {{car.label}}
        </ng-template>
      </p-listbox>
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagTipoPromo">
      <p-listbox [options]="lstProductosShow" [(ngModel)]="selected_producto1" filter="filter" [listStyle]="{'max-height':'130px'}"
        [style]="{'width':'100%','border-color': bcLstProdM }" (onChange)="onChangelbProd($event)" [disabled]="!flagTipoDesc">
        <p-header>
          Productos
        </p-header>
        <ng-template let-car pTemplate="item">
          {{car.label}}
          <span class="badge">$ {{ car.value.precio_venta | number : '1.2-2'}}</span>
          <span class="badge">$ {{ car.value.precio_costo | number : '1.2-2'}}</span>
        </ng-template>
      </p-listbox>
    </div>


    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagTipoPromo">
      <br>
      <label style="text-align: left">Porcentaje*:</label>
      <input currencyMask type="text" [(ngModel)]="descPercent" id="descPercent" name="descPercent" placeholder="0.00" class="form-control input-sm"
        (ngModelChange)="valueChangeDescPercent($event)" (click)="$event.target.select()" [options]="{ suffix :' %',prefix: ''}">
    </div>
    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6" *ngIf="flagUpdatePrize">
      <br>
      <label style="text-align: left">Valor*:</label>
      <input currencyMask type="text" [(ngModel)]="descMoney" id="descMoney" name="descMoney" placeholder="0.00" class="form-control input-sm"
        (ngModelChange)="valueChangeDescMoney($event)" (click)="$event.target.select()">
    </div>

  </div>
  <hr>
  <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="text-align: center">
    <button class="btn btn-primary" style="font-size: 11px" (click)="onAddPromoSubmit()" tabindex="4">Registrar</button>
    <button class="btn btn-default" style="font-size: 11px" (click)="showDialogPro = false">Cancelar</button>
  </div>
</p-dialog>

<!-- Update Promo -->
<p-dialog [(visible)]="showDialogProU" modal="modal" width="400" [responsive]="true">
  <p-header>
    Actualizar Promoción
  </p-header>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12">
      <label>Nombre*:</label>
      <input type="text" [(ngModel)]="objPromoUpdate.nombre" (ngModelChange)="onChangeNombrePromo($event)" id="nombrePromoU" name="nombrePromoU"
        placeholder="Nombre único de la promoción" class="form-control" onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
          event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
        tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " tabindex="1">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Desde*:</label>
      <input currencyMask type="text" [(ngModel)]="objPromoUpdate.desde" class="form-control input-sm" placeholder="0.00" tooltip="Cuando la cantidad vaya desde"
        tooltipPlacement="bottom" title=" " [options]="{ suffix :'',prefix: ''}" tabindex="2" id="desdePromoU" name="desdePromoU">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Hasta*:</label>
      <input currencyMask type="text" [(ngModel)]="objPromoUpdate.hasta" class="form-control input-sm" placeholder="0.00" tooltip="Hasta esta cantidad de producto"
        tooltipPlacement="bottom" title=" " [options]="{ suffix :'',prefix: ''}" tabindex="3" id="hastaPromoU" name="hastaPromoU">
    </div>
  </div>
  <hr>
  <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="text-align: center">
    <button class="btn btn-primary" style="font-size: 11px" (click)="onUpdatePromoSubmit()" tabindex="4">Registrar</button>
    <button class="btn btn-default" style="font-size: 11px" (click)="showDialogProU = false">Cancelar</button>
  </div>
</p-dialog>

<!-- Add Compra -->
<p-dialog [(visible)]="showDialogC" modal="modal" width="1050" [responsive]="true" positionTop="30">
  <p-header>
    Registrar Factura Compra
  </p-header>
  <form (ngSubmit)="onAddCompra()" #formC="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint"><b>Nota:</b> Los campos marcados con (*) son obligatorios.</div>
      </div>
      <!-- Datos Generales  -->
      <div class="ui-g-3">
        <label>Número Factura<span class="requiredClass">&nbsp;*</span></label>{{objCompras.num_factura | numFactura}}
        <input type="text" [(ngModel)]="objCompras.num_factura" [textMask]="{mask: mask}" (ngModelChange)="onChangeNumFact()" id="num_facturaC"
          name="num_facturaC" placeholder="999-999-999999999" class="form-control input-sm" tooltip="Solo se permiten NUMEROS."
          tooltipPlacement="bottom" required>
      </div>
      <div class="ui-g-3">
        <label>Fecha<span class="requiredClass">&nbsp;*</span></label>
        <p-calendar [(ngModel)]="objCompras.fecha" [locale]="es" dateFormat="dd/mm/yy" [showIcon]="true" [monthNavigator]="true"
          [yearNavigator]="true" yearRange="1950:2030" dataType="string" [readonlyInput]="true" id="fechaK" name="fechaK">
        </p-calendar>
      </div>
      <div class="ui-g-3">
        <label>Proveedor<span class="requiredClass">&nbsp;*</span></label>
        <div class="input-group">
          <select [(ngModel)]="objCompras.proveedor" (ngModelChange)="loadSailers($event)" id="proveC" name="proveC" class="form-control input-sm"
            required>
            <option value="" disabled selected hidden>Selecciona...</option>
            <option *ngFor="let c of lstProveedoresK" [ngValue]="c" >{{c.nombre_proveedor}}</option>
          </select>
          <span class="input-group-addon input-sm" id="spanAdd" (click)="showProveK()"><i class="fa fa-plus fa-lg" aria-hidden="true"></i></span>
        </div>
      </div>
      <div class="ui-g-3">
        <label>Vendedor<span class="requiredClass">&nbsp;*</span></label>
        <div class="input-group">
          <select [(ngModel)]="objCompras.vendedor" id="vendedorC" name="vendedorC" class="form-control input-sm">
            <option value="" selected>Sin Vendedor</option>
            <option *ngFor="let c of lstProveedoresR" [ngValue]="c" >{{c.nombre}}</option>
          </select>
          <span class="input-group-addon input-sm" id="spanAdd" (click)="showProveK()"><i class="fa fa-plus fa-lg" aria-hidden="true"></i></span>
        </div>
      </div>
      <!-- Listado productos -->
      <div class="ui-g-12">
        <p-dataTable [value]="lstComprasProve" [responsive]="true" [paginator]="true" [rows]="4">
          <p-header>
            <div class="ui-helper-clearfix" style="width:100%">
              <div class="ui-g-3 ui-g-nopad">
                <button pButton type="button" icon="fa-plus" (click)="showDialogProdC = true;" label="Añadir producto"></button>
              </div>
            </div>
          </p-header>
          <p-column [style]="{'overflow':'visible','width':'5%'}">
            <ng-template let-car="rowData" let-index="rowIndex" pTemplate>
              <button pButton type="button" (click)="deleteRowCompras(index)" icon="fa-close" class="ui-button-danger" style="height: 20px;"></button>
            </ng-template>
          </p-column>
          <p-column field="fecha" header="Fecha" [style]="{'overflow':'visible','width':'17.5%'}">
            <ng-template let-car="rowData" let-index="rowIndex" pTemplate>
              {{car.fecha | date:'dd/MM/yyyy HH:mm'}}
            </ng-template>
          </p-column>
          <p-column field="desc_producto" header="Descripción Producto" [style]="{'overflow':'visible','width':'33%'}"></p-column>
          <p-column field="cantidad" header="Cantidad" [style]="{'overflow':'visible','width':'14%'}">
            <ng-template let-car="rowData" let-index="rowIndex" pTemplate>
              {{car.cantidad | number : '1.2-2'}}
            </ng-template>
          </p-column>
          <p-column field="pcUnitario" header="P. unitario" [style]="{'overflow':'visible','width':'14%'}">
            <ng-template let-car="rowData" let-index="rowIndex" pTemplate>
              {{car.pcUnitario | number : '1.2-2'}}
            </ng-template>
          </p-column>
          <p-column field="total" header="Total" [style]="{'overflow':'visible','width':'16.5%'}">
            <ng-template let-car="rowData" let-index="rowIndex" pTemplate>
              {{car.total | number : '1.2-2'}}
            </ng-template>
          </p-column>
          <ng-template pTemplate="emptymessage">
            No existen registros
          </ng-template>
        </p-dataTable>
      </div>
      <!-- Formas de pago -->
      <div class="panel panel-default" style="width: 49%; margin-left: 7px;">
        <div class="ui-g-3">
          <label>Forma de Pago<span class="requiredClass">&nbsp;*</span></label>
        </div>
        <div class="ui-g-9">
          <div class="ui-state-error ui-message ui-corner-all" *ngIf="flagErrorFP" style="height: 27px;">
            <p style="color: white;font-size: 12px"><i class="fa fa-exclamation-circle"></i> &nbsp;El campo "<i>{{campoFP}}</i>", puede ser máximo: <i>{{maximoFP | number : '1.2-2'}}</i></p>
          </div>
          <div *ngIf="!flagErrorFP">
            <p style="color: white;font-size: 12px">Espacio</p>
          </div>
        </div>
        <div class="ui-g-6">
          <label>Efectivo:</label>
          <input currencyMask type="text" [(ngModel)]="objCompras.fpV.fpEfectivo" id="fpEfectivo" name="fpEfectivo" placeholder="0.00"
            class="form-control input-sm" (ngModelChange)="onChangeFPE($event)" (click)="$event.target.select()" [disabled]="flagConsCero">
        </div>
        <div class="ui-g-6">
          <label>Tarjeta Crédito:</label>
          <input currencyMask type="text" [(ngModel)]="objCompras.fpV.fpTarjeta" id="fpTarjeta" name="fpTarjeta" placeholder="0.00"
            class="form-control input-sm" (ngModelChange)="onChangeFPT($event)" (click)="$event.target.select()" [disabled]="flagConsCero">
        </div>
        <div class="ui-g-6">
          <label>Crédito Directo:</label>
          <input currencyMask type="text" [(ngModel)]="objCompras.fpV.fpPorCobrar" id="fpPorCobrar" name="fpPorCobrar" placeholder="0.00"
            class="form-control input-sm" (ngModelChange)="onChangeFPC($event)" (click)="$event.target.select()" [disabled]="flagConsCero">
        </div>
        <div class="ui-g-6">
          <label>Cheque:</label>
          <input currencyMask type="text" [(ngModel)]="objCompras.fpV.fpCheque" id="fpCheque" name="fpCheque" placeholder="0.00" class="form-control input-sm"
            (ngModelChange)="onChangeFPCH($event)" (click)="$event.target.select()" [disabled]="flagConsCero">
        </div>
      </div>
      <!-- Desgloce -->
      <div class="panel panel-default" style="width: 49%; margin-left: 6px;">
        <div class="ui-g-6">
          <label for="totalPagarC">Subtotal:</label>
          <input currencyMask type="text" [(ngModel)]="objDesgloce.subtotal" name="subtotal" class="form-control input-sm" readonly>
        </div>
        <div class="ui-g-6">
          <label for="totalPagarC">IVA 12%:</label>
          <input currencyMask type="text" [(ngModel)]="objDesgloce.iva" name="iva" class="form-control input-sm" readonly>
        </div>
        <div class="ui-g-6">
          <label for="totalPagarC">ICE:</label>
          <input currencyMask type="text" [(ngModel)]="objDesgloce.ice" name="ice" class="form-control input-sm" readonly>
        </div>
        <div class="ui-g-6">
          <label for="totalPagarC">Descuento:</label>
          <input currencyMask type="text" [(ngModel)]="objDesgloce.descuento" name="descuento" class="form-control input-sm" readonly>
        </div>
        <div class="ui-g-6 ui-g-offset-6">
          <label for="totalPagarC">Total:</label>
          <input currencyMask type="text" [(ngModel)]="objDesgloce.total" name="totalPagarC" class="form-control input-sm" readonly>
        </div>
      </div>
    </div>
    <div class="ui-g-12 ui-g-nopad" style="text-align: center">
      <button class="btn btn-primary" style="font-size: 11px" [disabled]="!formC.form.valid || validNumFact || !this.lstComprasProve.length > 0 || !(objCompras.fpV.fpEfectivo + objCompras.fpV.fpTarjeta + objCompras.fpV.fpPorCobrar + objCompras.fpV.fpCheque == this.objDesgloce.total)">Registrar</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDialogProU = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Add ProdCompra -->
<p-dialog [(visible)]="showDialogProdC" modal="modal" width="500" [responsive]="true">
  <p-header>
    Producto
  </p-header>
  <form (ngSubmit)="addProdCompra()" #tpProdCompraForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint"><b>Nota:</b> Los campos marcados con (*) son obligatorios.</div>
      </div>
      <div class="ui-g-12">
        <label>Descripción Producto<span style="color: #D9443D;">&nbsp;*</span></label>
        <p-selectButton name="selectedTipoProd" [options]="typesProd" [(ngModel)]="selectedTipoProd" (onChange)="changeTipoProd($event)"
          [style]="{'margin-top':'2px'}"></p-selectButton>
      </div>
      <div class="ui-g-6" *ngIf="flagProdC">
        <input type="text" name="desc_productoC" [(ngModel)]="objProdCompras.desc_producto" (ngModelChange)="onChangeNombreProdCompra($event)"
          minlength="5" id="desc_productoC" placeholder="Producto Nuevo" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          required>
      </div>
      <div class="ui-g-6" *ngIf="flagProdC">
        <select [(ngModel)]="selected_tipo_producto" id="tipoPC" name="tipoPC" class="form-control input-sm" required>
          <option value="" disabled selected hidden>Selecciona...</option>
          <option *ngFor="let c of tipo_productos" [ngValue]="c">{{c.desc_tipo_producto}}</option>
        </select>
      </div>
      <div class="ui-g-12" *ngIf="!flagProdC">
        <p-dropdown name="selectedProdCompras" [options]="productosShow" [(ngModel)]="objProdCompras.desc_producto" (onChange)="onChangeProdCompra()"
          placeholder="Selecciona.." [style]="{'width':'100%'}" filter="true" required>
          <ng-template let-brand pTemplate="item">
            <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
              <div style="font-size:18px;float:left;margin:10px 10px 0 0">{{brand.label}}--{{brand.id_tipo_producto}}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="ui-g-6">
        <label>Cantidad<span style="color: #D9443D;">&nbsp;*</span></label>
        <input name="objProdComprasCant" [(ngModel)]="objProdCompras.cantidad" (ngModelChange)="onChangeCantProdCompra($event)" currencyMask
          type="text" [options]="{ prefix: ''}" id="cantK" name="cantK" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()"
          required>
      </div>
      <div class="ui-g-6">
        <label>Precio Costo Unitario<span style="color: #D9443D;">&nbsp;*</span></label>
        <input name="objProdComprasPU" [(ngModel)]="objProdCompras.pcUnitario" (ngModelChange)="onChangePCUProdCompra($event)" currencyMask
          type="text" [options]="{ prefix: '$ '}" id="totalK" name="totalK" placeholder="0.00" class="form-control input-sm"
          (click)="$event.target.select()" required>
      </div>
      <div class="ui-g-6">
        <label>Unidad de Medida<span *ngIf="flagProdC" style="color: #D9443D;">&nbsp;*</span></label>
        <select name="selectedUmMatC" [(ngModel)]="selectedUmMat" (ngModelChange)="onChangeUmMat($event)" id="tipoUmMat" class="form-control input-sm"
          [disabled]="!flagProdC">
        <option *ngFor="let c of lstUnidadMedida" [ngValue]="c">{{c.label}}</option>
        </select>
        <select name="selectedUmMatC1" [(ngModel)]="selectedUmMat1" id="tipoUmMat" class="form-control input-sm" *ngIf="flagUnits"
          style="margin-top: 10px;" [disabled]="!flagProdC">
          <option *ngFor="let c of lstUnidadMedida1" [ngValue]="c">{{c.label}}</option>
        </select>
      </div>
      <div class="ui-g-6" *ngIf="flagUnits">
        <label>Contenido (Si aplica)<span *ngIf="flagProdC" style="color: #D9443D;">&nbsp;*</span></label>
        <input name="contProdCompra" currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="objProdCompras.contenido" id="cantMat"
          placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()" [disabled]="!flagProdC">
      </div>
      <div class="ui-g-6" *ngIf="!flagProdC">
        <label>Precio Costo Anterior:</label>
        <p class="ids">&nbsp;{{objProdCompras.pcAnterior | number : '1.2-2'}}</p>
      </div>
      <div class="ui-g-6">
        <label>Total:</label>
        <p class="ids">&nbsp;{{ objProdCompras.pcUnitario * objProdCompras.cantidad | number : '1.2-2'}}</p>
      </div>
      <div class="ui-g-12">
        <md-checkbox name="checkedC" [(ngModel)]="checkedC" [color]="color">¿Usar éste producto cómo materia prima?</md-checkbox>
        <hr>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <button class="btn btn-primary" style="font-size: 11px" [disabled]="!tpProdCompraForm.form.valid || !flagCantPC || !flagPrecioCostoPC">
        &nbsp;&nbsp;&nbsp;Añadir&nbsp;&nbsp;&nbsp;</button>
      <button class="btn btn-default" style="font-size: 11px" (click)="showDialogProdC = false">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Add Kardex-->
<!--<p-dialog [(visible)]="showDialogK" modal="modal" width="550" [responsive]="true">
  <p-header>
    Registrar Compra
  </p-header>
  <br>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12">
      <label>Descripción Producto*:</label>
      <p-selectButton [options]="types" [(ngModel)]="selectedIeProd" (onChange)="onClickSelectButton($event)" [style]="{'margin-top':'2px'}"></p-selectButton>
    </div>
    <div class="ui-g-12" *ngIf="flagProdK">
      <input type="text" [(ngModel)]="kardex.desc_producto" (ngModelChange)="onChangeNombrePK($event)" id="desc_productoK" name="desc_productoK"
        placeholder="Producto Nuevo" class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'>
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <select [(ngModel)]="selectedTP" (ngModelChange)="onChangelstTP($event)" class="form-control input-sm">
        <option *ngFor="let c of tipo_productos" [ngValue]="c" >{{c.desc_tipo_producto}}</option>
      </select>
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <select [(ngModel)]="kardex.desc_producto" (ngModelChange)="onChangeProdK($event)" class="form-control input-sm" id="desc_productoK1"
        name="desc_productoK1">
          <option *ngFor="let c of lstProductos" [ngValue]="c" >{{c.label}}</option>
        </select>
    </div>
    <div class="ui-g-12">
      <label>Proveedor*:</label>
      <div class="input-group">
        <select [(ngModel)]="kardex.proveedor" id="selectProve" name="selectProve" class="form-control input-sm">
          <option *ngFor="let c of lstProveedoresK" [ngValue]="c" >{{c.nombre_proveedor}}</option>
        </select>
        <span class="input-group-addon input-sm" id="spanAdd" (click)="showProveK()"><i class="fa fa-plus fa-lg" aria-hidden="true"></i></span>
      </div>
    </div>
    <div class="ui-g-6">
      <label>Número Factura*:</label>
      <input type="text" [(ngModel)]="kardex.num_factura" id="num_facturaK" name="num_facturaK" placeholder="Número de Factura"
        class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'>
    </div>
    <div class="ui-g-6">
      <label>Fecha*:</label>
      <p-calendar [(ngModel)]="kardex.fecha" [locale]="es" dateFormat="dd/mm/yy" [showIcon]="true" [monthNavigator]="true" [yearNavigator]="true"
        yearRange="1950:2030" dataType="string" [readonlyInput]="true" id="fechaK" name="fechaK">
      </p-calendar>
    </div>
    <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12">
      <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="padding: 0">
        <label>Contenido Unidad*:</label>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6" style="padding: 2px">
        <p-selectButton [options]="lstContenido" [(ngModel)]="selectedLstContenido"></p-selectButton>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6" style="padding: 0; padding-left: 7px">
        <input type="text" currencyMask [options]="{ prefix: ''}" type="text" [(ngModel)]="kardex.contenido" id="contK" name="contK"
          placeholder="0.00" class="form-control input-sm" tooltip="Al almacenar el valor, el sistema realizará la conversión a ml."
          tooltipPlacement="bottom" (click)="$event.target.select()" [readonly]="!flagProdK">
      </div>
    </div>
    <div class="ui-g-6">
      <label>Unidades*:</label>
      <input [(ngModel)]="kardex.cantidad" (ngModelChange)="onChangeUnidades($event)" currencyMask type="text" [options]="{ prefix: ''}"
        id="cantK" name="cantK" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-6">
      <label>Total*:</label>
      <input [(ngModel)]="kardex.total" (ngModelChange)="onChangeTotalK($event)" currencyMask type="text" [options]="{ prefix: '$ '}"
        id="totalK" name="totalK" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-12">
      <md-checkbox [(ngModel)]="checkedK" [color]="color">¿Usar este producto como materia prima?</md-checkbox>
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <label>Precio Costo Actual*:</label>&nbsp;{{newProd.precio_costo | number : '1.2-2'}}
    </div>
    <div class="ui-g-6">
      <label>Precio Costo Nuevo*:</label>&nbsp;{{prizeKardex | number : '1.2-2'}}
    </div>
  </div>
  <div class="ui-g-12" style="text-align: center">
    <hr>
    <button type="button" style="font-size: 11px" (click)="saveKardex()" class="btn btn-primary" [disabled]="false">Registrar</button>
    <button type="button" style="font-size: 11px" (click)="showDialogK=false" class="btn btn-default">Cancelar</button>
  </div>
</p-dialog>-->

<!-- Update Kardex-->
<!--<p-dialog [(visible)]="showDialogKU" modal="modal" width="550" [responsive]="true">
  <p-header>
    Actualizar Compra
  </p-header>
  <br>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12">
      <label>Descripción Producto*:</label>
      <p-selectButton [options]="types" [(ngModel)]="selectedIeProd" (onChange)="onClickSelectButtonU($event)" [style]="{'margin-top':'2px'}"></p-selectButton>
    </div>
    <div class="ui-g-12" *ngIf="flagProdK">
      <input type="text" [(ngModel)]="kardexU.desc_producto" (ngModelChange)="onChangeNombrePKU($event)" id="desc_productoKU" name="desc_productoKU"
        placeholder="Producto Nuevo" class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'>
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <select [(ngModel)]="selectedTP" (ngModelChange)="onChangelstTPU($event)" class="form-control input-sm">
        <option *ngFor="let c of tipo_productos" [ngValue]="c" >{{c.desc_tipo_producto}}</option>
      </select>
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <select [(ngModel)]="kardexU.desc_producto" class="form-control input-sm" id="desc_productoK1U" name="desc_productoK1U">
        <option *ngFor="let c of lstProductos" [ngValue]="c" >{{c.label}}</option>
      </select>
    </div>
    <div class="ui-g-12">
      <label>Proveedor*:</label>
      <div class="input-group">
        <select [(ngModel)]="kardexU.proveedor" id="selectProve" name="selectProve" class="form-control input-sm">
          <option *ngFor="let c of lstProveedoresK" [ngValue]="c" >{{c.nombre_proveedor}}</option>
        </select>
        <span class="input-group-addon input-sm" id="spanAdd" (click)="showProveK()"><i class="fa fa-plus fa-lg" aria-hidden="true"></i></span>
      </div>
    </div>
    <div class="ui-g-6">
      <label>Número Factura*:</label>
      <input type="text" [(ngModel)]="kardexU.num_factura" id="num_facturaKU" name="num_facturaKU" placeholder="Número de Factura"
        class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'>
    </div>
    <div class="ui-g-6">
      <label>Fecha*:</label>
      <p-calendar [(ngModel)]="kardexU.fecha" [locale]="es" dateFormat="dd/mm/yy" [showIcon]="true" [monthNavigator]="true" [yearNavigator]="true"
        yearRange="1950:2030" dataType="string" [readonlyInput]="true" id="fechaK" name="fechaK">
      </p-calendar>
    </div>

    <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12">
      <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="padding: 0">
        <label>Contenido Unidad*:</label>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6" style="padding: 2px">
        <p-selectButton [options]="lstContenido" [(ngModel)]="selectedLstContenido"></p-selectButton>
      </div>
      <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6" style="padding: 0; padding-left: 7px">
        <input type="text" currencyMask [options]="{ prefix: ''}" type="text" [(ngModel)]="kardexU.contenido" id="contKU" name="contKU"
          placeholder="0.00" class="form-control input-sm" tooltip="Al almacenar el valor, el sistema realizará la conversión a ml."
          tooltipPlacement="bottom" (click)="$event.target.select()" [readonly]="!flagProdK">
      </div>
    </div>
    <div class="ui-g-6">
      <label>Unidades*:</label>
      <input [(ngModel)]="kardexU.cantidad" (ngModelChange)="onChangeUnidadesU($event)" currencyMask type="text" [options]="{ prefix: ''}"
        id="cantKU" name="cantKU" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-6">
      <label>Total*:</label>
      <input [(ngModel)]="kardexU.total" (ngModelChange)="onChangeTotalKU($event)" currencyMask type="text" [options]="{ prefix: ''}"
        id="totalKU" name="totalKU" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-6" *ngIf="!flagProdK">
      <label>Precio Costo Actual*:</label>&nbsp;{{newProd.precio_costo | number : '1.2-2'}}
    </div>
    <div class="ui-g-6">
      <label>Precio Costo Nuevo*:</label>&nbsp;{{prizeKardex | number : '1.2-2'}}
    </div>
  </div>
  <div class="ui-g-12" style="text-align: center">
    <hr>
    <button type="button" style="font-size: 11px" (click)="updateKardex()" class="btn btn-primary" [disabled]="false">Actualizar</button>
    <button type="button" style="font-size: 11px" (click)="showDialogKU=false" class="btn btn-default">Cancelar</button>
  </div>
</p-dialog>-->

<!-- Add Proveedor-->
<p-dialog [(visible)]="showDialogProve" modal="modal" width="600" [responsive]="true">
  <p-header>
    Registrar Proveedor
  </p-header>
  <form (ngSubmit)="saveProveedor()" #proveForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint">Los campos marcados con (*) son obligatorios:</div>
      </div>
      <div class="ui-g-6">
        <label>Nombre*:</label>
        <input type="text" [(ngModel)]="objProve.nombre_proveedor" (ngModelChange)="onChangeNombreProve($event)" id="nombreProve"
          name="nombreProve" placeholder="Nombre proveedor" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" minlength="8" tabindex="1"
          required>
      </div>
      <div class="ui-g-6">
        <label>Ruc*:</label>
        <input type="text" [(ngModel)]="objProve.ruc" (ngModelChange)="onChangeRuc()" id="rucProve" name="rucProve" placeholder="Ruc proveedor"
          class="form-control input-sm" maxlength="13" onkeypress='return event.charCode >= 48 && event.charCode <= 57' tooltip="Solo se permiten NUMEROS."
          tooltipPlacement="bottom" tabindex="2">
      </div>
      <div class="ui-g-6">
        <label>Teléfono*:</label>
        <input type="tel" [(ngModel)]="objProve.telefono" id="telProve" name="telProve" placeholder="Teléfono proveedor" class="form-control input-sm"
          minlength="7" maxlength="10" onkeypress='return event.charCode >= 48 && event.charCode <= 57' tooltip="Solo se permiten NUMEROS."
          tooltipPlacement="bottom" tabindex="3" required>
      </div>
      <div class="ui-g-6">
        <label>E-mail:</label>
        <input type="text" [(ngModel)]="objProve.correo" (ngModelChange)="onChangeEmail($event)" id="correo" name="correo" placeholder="Correo proveedor"
          class="form-control input-sm" tabindex="4">
      </div>
      <div class="ui-g-6">
        <div class="ui-g-12" style="padding:0px 0px 7px 0px">
          <label>Ciudad:</label>
          <p-autoComplete [(ngModel)]="objProve.ciudad" [suggestions]="filteredCiudades" (completeMethod)="filterCiudad($event)" field="nombre"
            id="ciudadProve" name="ciudadProve" [size]="30" placeholder="&nbsp;&nbsp;Ciudad Proveedor" [minLength]="1" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90'
            tabindex="5"></p-autoComplete>
        </div>
        <div class="ui-g-12" style="padding-left: 0px; padding-right: 0px;">
          <label>Dirección:</label><br>
          <textarea pInputTextarea [(ngModel)]="objProve.direccion" id="dirProve" name="dirProve" placeholder="Dirección proveedor"
            class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
            tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " tabindex="7"
            [rows]="2"></textarea>
        </div>
      </div>
      <div class="ui-g-6">
        <label>Representante:</label>
        <span style="background-color: #2196F3; border-color: #2196F3" class="input-group-addon input-sm classAddIcon" (click)="showRepre()"><i style="color: white" class="fa fa-plus-square fa-lg" aria-hidden="true"></i></span>
        <p-listbox [options]="objProve.representanteV" [style]="{'text-align':'left','max-height':'90px','height':'90px','width':'100%'}"
          id="representante" name="representante">
          <ng-template let-car pTemplate="item">
            {{car.nombre}}
          </ng-template>
        </p-listbox>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <hr>
      <button type="submit" style="font-size: 11px" class="btn btn-primary" [disabled]="objProve.correo == undefined || objProve.correo == '' ?  !proveForm.form.valid || validRuc: !proveForm.form.valid && validRuc || validCorreo"
        tabindex="8">Registrar</button>
      <button type="button" style="font-size: 11px" (click)="showDialogProve=false" class="btn btn-default" tabindex="9">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Update Proveedor-->
<p-dialog [(visible)]="showDialogProveU" modal="modal" width="600" [responsive]="true">
  <p-header>
    Actualizar Proveedor
  </p-header>
  <form (ngSubmit)="updateProveedor()" #proveForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint">Los campos marcados con (*) son obligatorios:</div>
      </div>
      <div class="ui-g-6">
        <label>Nombre*:</label>
        <input type="text" [(ngModel)]="objProve.nombre_proveedor" (ngModelChange)="onChangeNombreProve($event)" id="nombreProveU"
          name="nombreProveU" placeholder="Nombre proveedor" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " tabindex="1"
          required>
      </div>
      <div class="ui-g-6">
        <label>Ruc*:</label>
        <input type="text" [(ngModel)]="objProve.ruc" (ngModelChange)="onChangeRucU()" id="rucProveU" name="rucProveU" placeholder="Ruc Proveedor"
          class="form-control input-sm" maxlength="13" onkeypress='return event.charCode >= 48 && event.charCode <= 57' tooltip="Solo se permiten NUMEROS."
          tooltipPlacement="bottom" tabindex="2">
      </div>
      <div class="ui-g-6">
        <label>Teléfono*:</label>
        <input type="text" [(ngModel)]="objProve.telefono" id="telProve" name="telProve" placeholder="Teléfono Proveedor" class="form-control input-sm"
          maxlength="10" onkeypress='return event.charCode >= 48 && event.charCode <= 57' tooltip="Solo se permiten NUMEROS."
          tooltipPlacement="bottom" tabindex="3" required>
      </div>
      <div class="ui-g-6">
        <label>E-mail:</label>
        <input type="text" [(ngModel)]="objProve.correo" (ngModelChange)="onChangeEmailU($event)" id="correoU" name="correoU" placeholder="Correo del cliente"
          class="form-control input-sm" tabindex="4">
      </div>
      <div class="ui-g-6">
        <div class="ui-g-12" style="padding:0px 0px 7px 0px">
          <label>Ciudad:</label>
          <p-autoComplete [(ngModel)]="objProve.ciudad" [suggestions]="filteredCiudades" (completeMethod)="filterCiudad($event)" [size]="30"
            [minLength]="1" placeholder="Ciudad Proveedor" field="nombre" name="ciudadProve">
            <ng-template let-brand pTemplate="item">
              <div class="ui-helper-clearfix" style="border-bottom:1px solid #D5D5D5">
                <div style="font-size:18px;float:left;margin:10px 10px 0 0">{{brand.nombre}}--{{brand.provincia}}</div>
              </div>
            </ng-template>
          </p-autoComplete>

        </div>
        <div class="ui-g-12" style="padding-left: 0px; padding-right: 0px;">
          <label>Dirección:</label>
          <textarea pInputTextarea [(ngModel)]="objProve.direccion" id="dirProve" name="dirProve" placeholder="Dirección proveedor"
            class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
            tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " tabindex="6"
            [rows]="2"></textarea>
        </div>
      </div>
      <div class="ui-g-6">
        <label>Representante:</label>
        <span style="background-color: #2196F3; border-color: #2196F3" class="input-group-addon input-sm classAddIcon" (click)="showRepre()"><i style="color: white" class="fa fa-plus-square fa-lg" aria-hidden="true"></i></span>
        <p-listbox [options]="objProve.representanteV" [style]="{'text-align':'left','max-height':'90px','height':'90px','width':'100%'}"
          id="representante" name="representante">
          <ng-template let-car pTemplate="item">
            {{car.nombre}}
          </ng-template>
        </p-listbox>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <hr>
      <button type="submit" style="font-size: 11px" class="btn btn-primary" [disabled]="objProve.correo == undefined || objProve.correo == '' ?  !proveForm.form.valid || validRuc: !proveForm.form.valid && validRuc || validCorreo"
        tabindex="7">Actualizar</button>
      <button type="button" style="font-size: 11px" (click)="showDialogProveU=false" class="btn btn-default" tabindex="8">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Add Representante -->
<p-dialog [(visible)]="showRepresentante" modal="modal" width="500" [responsive]="true">
  <p-header>
    Registrar Representante
  </p-header>
  <form (ngSubmit)="addRepre()" #heroForm="ngForm">
    <div class="ui-g ui-fluid">
      <div class="ui-g-12">
        <div class="form-hint"><b>Nota:</b>&nbsp;Los campos marcados con (*) son obligatorios.</div>
      </div>
      <div class="ui-g-12">
        <label>Nombre y Apellido<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" [(ngModel)]="representante.nombre" (ngModelChange)="onChangeNombreRepre($event)" id="nombreRepre" name="nombreRepre"
          placeholder="Nombre de representante" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
        event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90'
          tooltip="Solo se permiten LETRAS." tooltipPlacement="bottom" minlength="8" tabindex="10" required>
      </div>
      <div class="ui-g-6">
        <label>Teléfono<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" [(ngModel)]="representante.telefono" id="telRepre" name="telRepre" placeholder="Teléfono representante"
          class="form-control input-sm" minlength="7" maxlength="10" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
          tooltip="Solo se permiten NUMEROS." tooltipPlacement="bottom" tabindex="11" required>
      </div>
      <div class="ui-g-6">
        <label>E-mail<span class="requiredClass">&nbsp;*</span></label>
        <input type="text" [(ngModel)]="representante.correo" (ngModelChange)="onChangeEmailRepre($event)" id="correoRepre" name="correoRepre"
          placeholder="Correo representante" class="form-control input-sm" tabindex="12">
      </div>
      <div class="ui-g-12">
        <label>Descripción:</label><br>
        <textarea pInputTextarea [(ngModel)]="representante.descripcion" (ngModelChange)="onChangeDescRepre($event)" id="descRepre"
          name="descRepre" placeholder="Descripción representante" class="form-control input-sm" onkeypress='return event.charCode >= 97 && event.charCode <= 122 || event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
          tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" " tabindex="13"
          [rows]="3"></textarea>
      </div>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <hr>
      <button type="submit" style="font-size: 11px" [disabled]="!heroForm.form.valid || flagEmailRepre" class="btn btn-primary"
        tabindex="14">Registrar</button>
      <button type="button" style="font-size: 11px" (click)="showRepresentante=false" class="btn btn-default" tabindex="15">Cancelar</button>
    </div>
  </form>
</p-dialog>

<!-- Show Compras-->
<p-dialog [(visible)]="showComprasDetail" modal="modal" width="600" [responsive]="true">
  <p-header>
    Detalle Compras
  </p-header>
  <br>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12">
      <p><strong>Nota:</strong> Las compras que se muestran a continuación, corresponden a los ultimos 24 meses al proveedor:
        <strong>{{showProveDialog}}</strong>.</p>
      <p-dataTable [value]="lstComprasProve" [responsive]="true" [paginator]="true" [rows]="5">
        <p-column field="fecha" header="Fecha" [style]="{'overflow':'visible','width':'25%'}"></p-column>
        <p-column field="desc_producto" header="Descripción Producto" [style]="{'overflow':'visible','width':'35%'}"></p-column>
        <p-column field="unidades" header="Unidades" [style]="{'overflow':'visible','width':'20%'}"></p-column>
        <p-column field="total" header="Total" [style]="{'overflow':'visible','width':'20%'}"></p-column>
      </p-dataTable>
    </div>
  </div>
  <div class="ui-g-12" style="text-align: center">
    <hr>
    <button type="button" style="font-size: 11px" (click)="showComprasDetail=false" class="btn btn-primary">Entendido</button>
  </div>
</p-dialog>

<!-- Show Ventas-->
<p-dialog [(visible)]="showVentasDetail" modal="modal" width="500" [responsive]="true">
  <p-header>
    Detalle Ventas
  </p-header>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12">
      <label>Nombre del Producto*:</label>
      <input [(ngModel)]="showProdDialog" type="text" class="form-control input-sm" [readonly]="true">
    </div>
    <div class="ui-g-12">
      <label>Tipo de Resumen*:</label>
      <select [(ngModel)]="selectedTR" (ngModelChange)="onChangelstTR($event)" class="form-control input-sm">
        <option *ngFor="let c of tipo_resumen_ventas" [ngValue]="c" >{{c.label}}</option>
      </select>
    </div>
    <div class="ui-g-12" *ngIf="!flagResumenVentas">
      <label>Frecuencia*:</label>
      <select [(ngModel)]="selectedFrecuencia" (ngModelChange)="onChangeFrecuencia($event)" class="form-control input-sm">
        <option *ngFor="let c of lstFrecuencias" [ngValue]="c" >{{c.label}}</option>
      </select>
    </div>
    <div class="ui-g-6" *ngIf="flagResumenVentas">
      <label>Desde*:</label>
      <p-calendar [(ngModel)]="selectedDesde" [locale]="es" dateFormat="dd/mm/yy" [showIcon]="true" [monthNavigator]="true" [yearNavigator]="true"
        yearRange="1950:2030" dataType="string" [readonlyInput]="true" id="fechaK" name="fechaK">
      </p-calendar>
    </div>
    <div class="ui-g-6" *ngIf="flagResumenVentas">
      <label>Hasta*:</label>
      <p-calendar [(ngModel)]="selectedHasta" [locale]="es" dateFormat="dd/mm/yy" [showIcon]="true" [monthNavigator]="true" [yearNavigator]="true"
        yearRange="1950:2030" dataType="string" [readonlyInput]="true" id="fechaK" name="fechaK">
      </p-calendar>
    </div>
    <div class="ui-g-12" style="text-align: center">
      <br><br>
      <label>Total de Unidades Vendidas:</label>
      <h3>800</h3>
      <br><br>
      <hr>
    </div>
  </div>
  <div class="ui-g-12" style="text-align: center">
    <button type="button" style="font-size: 11px" (click)="showVentasDetail=false" class="btn btn-primary">Entendido</button>
  </div>
</p-dialog>

<!-- Add Materia-->
<p-dialog [(visible)]="showDialogMat" modal="modal" width="500" [responsive]="true">
  <p-header>
    Registrar Materia Prima
  </p-header>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12">
      <label for="nombrePC">Nombre*:</label>
      <input type="text" [(ngModel)]="objMat.nombre" (ngModelChange)="onChangeNombreMat($event)" id="nombreMat" name="nombreMat"
        placeholder="Nombre único de la materia prima" class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
        event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
        tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" ">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Cantidad Existente*:</label>
      <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="objMat.cant_existente" id="cantMat" placeholder="0.00"
        class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Precio Costo Unitario*:</label>
      <input currencyMask type="text" [(ngModel)]="objMat.precio_costo" id="pcMat" placeholder="0.00" class="form-control input-sm"
        (click)="$event.target.select()">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Unidad de Medida*:</label>
      <select [(ngModel)]="selectedUmMat" (ngModelChange)="onChangeUmMat($event)" id="tipoUmMat" class="form-control input-sm">
        <option *ngFor="let c of lstUnidadMedida" [ngValue]="c">{{c.label}}</option>
      </select>
      <select [(ngModel)]="selectedUmMat1" id="tipoUmMat" class="form-control input-sm" *ngIf="flagUnits" style="margin-top: 10px;">
        <option *ngFor="let c of lstUnidadMedida1" [ngValue]="c">{{c.label}}</option>
      </select>
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label *ngIf="flagUnits">Contenido (Si aplica):</label>
      <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="objMat.contenido" id="cantMat" placeholder="0.00"
        class="form-control input-sm" *ngIf="flagUnits" (click)="$event.target.select()">
    </div>
  </div>

  <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="text-align: center">
    <hr>
    <button class="btn btn-primary" style="font-size: 11px; width: 25%" (click)="onAddMatSubmit()">Registrar</button>
    <button class="btn btn-default" style="font-size: 11px; width: 25%" (click)="showDialogMat = false">Cancelar</button>
  </div>
</p-dialog>

<!-- Update Materia-->
<p-dialog [(visible)]="showDialogMatU" modal="modal" width="500" [responsive]="true">
  <p-header>
    Actualizar Materia Prima
  </p-header>
  <div class="ui-g ui-fluid">
    <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12">
      <label for="nombrePC">Nombre*:</label>
      <input type="text" [(ngModel)]="objMat.nombre" (ngModelChange)="onChangeNombreMat($event)" id="nombreMatU" name="nombreMat"
        placeholder="Nombre único de la materia prima" class="form-control input-sm" required onkeypress='return event.charCode >= 97 && event.charCode <= 122 ||
        event.charCode === 241 || event.charCode === 32 || event.charCode === 209 || event.charCode >= 65 && event.charCode <= 90 || event.charCode >= 45 && event.charCode <= 57'
        tooltip="Solo se permiten numeros, letras y ./- para este campo" tooltipPlacement="bottom" title=" ">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Cantidad Existente*:</label>
      <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="objMat.cant_existente" placeholder="0.00" class="form-control input-sm"
        (click)="$event.target.select()">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Precio Costo Unitario*:</label>
      <input currencyMask type="text" [(ngModel)]="objMat.precio_costo" placeholder="0.00" class="form-control input-sm" (click)="$event.target.select()">
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label>Unidad de Medida*:</label>
      <select [(ngModel)]="selectedUmMat" (ngModelChange)="onChangeUmMat($event)" class="form-control input-sm">
        <option *ngFor="let c of lstUnidadMedida" [ngValue]="c">{{c.label}}</option>
      </select>
      <select [(ngModel)]="selectedUmMat1" class="form-control input-sm" *ngIf="flagUnits" style="margin-top: 10px;">
        <option *ngFor="let c of lstUnidadMedida1" [ngValue]="c">{{c.label}}</option>
      </select>
    </div>
    <div class="ui-g-6 ui-xl-6 ui-lg-6 ui-md-6 ui-sm-6">
      <label *ngIf="flagUnits">Contenido (Si aplica):</label>
      <input currencyMask type="text" [options]="{ prefix: ''}" [(ngModel)]="objMat.contenido" placeholder="0.00" class="form-control input-sm"
        *ngIf="flagUnits" (click)="$event.target.select()">
    </div>
  </div>

  <div class="ui-g-12 ui-xl-12 ui-lg-12 ui-md-12 ui-sm-12" style="text-align: center">
    <hr>
    <button class="btn btn-primary" style="font-size: 11px; width: 25%" (click)="onUpdateMatSubmit()">Actualizar</button>
    <button class="btn btn-default" style="font-size: 11px; width: 25%" (click)="showDialogMatU = false">Cancelar</button>
  </div>
</p-dialog>